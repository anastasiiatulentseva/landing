---
import MobileMenu from "../components/MobileMenu.astro";
import "../styles/global.css";

interface NavLink {
  href: string;
  label: string;
  ariaLabel?: string;
  external?: boolean;
  download?: boolean | string;
}

interface Props {
  title: string;
  description?: string;
  noindex?: boolean;
  navLinks?: NavLink[];
  headerName?: string;
}

const { title, description = "", noindex = false, navLinks: navLinksProp, headerName = "A. Tulentseva" } = Astro.props;

const defaultNavLinks: NavLink[] = [
  { href: "/#competencies", label: "Expertise", ariaLabel: "Go to Expertise section" },
  { href: "/#experience", label: "Track Record", ariaLabel: "Go to Track Record section" },
  { href: "/#testimonials", label: "Testimonials", ariaLabel: "Go to Testimonials section" },
];
const navLinks = navLinksProp ?? defaultNavLinks;
---

<!doctype html>
<html lang="en" class="scroll-smooth scroll-pt-24">
  <head>
    <slot name="head" />
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content={description} />
    <title>{title}</title>
    {noindex && <meta name="robots" content="noindex, nofollow" />}
    <link rel="icon" href="/favicon.ico?v=2" sizes="any" />
    <link rel="icon" type="image/png" href="/favicon-32x32.png?v=2" sizes="32x32" />
    <link rel="apple-touch-icon" href="/apple-touch-icon.png?v=2" />
    <link rel="manifest" href="/site.webmanifest" />

    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&family=Playfair+Display:ital,wght@0,400;0,600;0,700;1,400&display=swap"
      rel="stylesheet"
    />

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-2MMJ3QV6N8"></script>
    <script is:inline>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-2MMJ3QV6N8');
    </script>
  </head>

  <body
    id="top"
    class="min-h-screen flex flex-col bg-paper text-charcoal font-sans antialiased selection:bg-gold selection:text-white"
  >
    <nav
      class="sticky top-0 z-[110] w-full bg-paper/90 backdrop-blur-sm border-b border-gray-200/50 transition-all duration-300 print:hidden"
    >
      <div class="max-w-6xl mx-auto px-6 h-20 flex justify-between items-center">
        <a
          href="/"
          class="font-serif text-2xl font-bold tracking-tight hover:text-gold transition-colors"
        >
          {headerName}<span class="text-gold">.</span>
        </a>

        <div class="hidden md:flex gap-8 text-sm font-medium text-gray-500">
          {navLinks.map(({ href, label, ariaLabel, external, download }) => (
            <a
              href={href}
              class="hover:text-charcoal transition-colors"
              aria-label={ariaLabel ?? `Go to ${label} section`}
              target={external ? "_blank" : undefined}
              rel={external ? "noopener noreferrer" : undefined}
              download={download === true ? "" : (download || undefined)}
            >
              {label}
            </a>
          ))}
        </div>

        <div class="flex items-center gap-4">
          <button
            type="button"
            id="menu-toggle"
            aria-expanded="false"
            aria-controls="mobile-menu"
            aria-label="Open menu"
            class="md:hidden p-2 text-charcoal hover:text-gold transition-colors"
          >
            <svg
              id="menu-icon"
              xmlns="http://www.w3.org/2000/svg"
              width="24"
              height="24"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
              stroke-linecap="round"
              stroke-linejoin="round"
            >
              <line x1="4" x2="20" y1="12" y2="12"></line>
              <line x1="4" x2="20" y1="6" y2="6"></line>
              <line x1="4" x2="20" y1="18" y2="18"></line>
            </svg>
            <svg
              id="close-icon"
              xmlns="http://www.w3.org/2000/svg"
              width="24"
              height="24"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
              stroke-linecap="round"
              stroke-linejoin="round"
              class="hidden"
            >
              <path d="M18 6 6 18"></path>
              <path d="m6 6 12 12"></path>
            </svg>
          </button>

          <a
            href="mailto:anastasiia.tulentseva@gmail.com"
            class="md:hidden text-charcoal hover:text-gold transition-colors p-2"
            aria-label="Email Me"
          >
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="24"
              height="24"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
              stroke-linecap="round"
              stroke-linejoin="round"
            >
              <rect x="2" y="4" width="20" height="16" rx="2"></rect>
              <path d="m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7"></path>
            </svg>
          </a>

          <a
            href="mailto:anastasiia.tulentseva@gmail.com"
            class="hidden md:inline-flex items-center justify-center px-6 py-2.5 text-sm font-medium text-white bg-charcoal rounded-md hover:bg-gray-800 transition-all shadow-sm"
          >
            Get in Touch
          </a>
        </div>
      </div>
    </nav>

    <MobileMenu links={navLinks} />

    <div class="flex-1">
      <slot />
    </div>

    <footer class="w-full py-12 px-6 bg-paper border-t border-gray-200 print:hidden">
      <div
        class="w-full max-w-5xl mx-auto flex flex-col md:flex-row justify-between items-center gap-6 min-w-0"
      >
        <div class="font-serif text-xl font-bold text-charcoal">
          A. Tulentseva<span class="text-gold">.</span>
        </div>

        <div class="flex gap-8">
          <a
            href="https://github.com/anastasiiatulentseva"
            target="_blank"
            rel="noopener noreferrer"
            class="text-gray-500 hover:text-gold transition-colors"
            aria-label="GitHub"
          >
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22" />
            </svg>
          </a>
          <a
            href="https://www.linkedin.com/in/atulentseva/"
            target="_blank"
            rel="noopener noreferrer"
            class="text-gray-500 hover:text-gold transition-colors"
            aria-label="LinkedIn"
          >
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z" />
              <rect x="2" y="9" width="4" height="12"></rect>
              <circle cx="4" cy="4" r="2"></circle>
            </svg>
          </a>
          <a
            href="mailto:anastasiia.tulentseva@gmail.com"
            class="text-gray-500 hover:text-gold transition-colors"
            aria-label="Email"
          >
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z" />
              <polyline points="22,6 12,13 2,6"></polyline>
            </svg>
          </a>
        </div>

        <div class="text-sm text-gray-400">Â© 2026 Anastasia Tulentseva.</div>
      </div>
    </footer>

    <script>
      (function () {
        const menuToggle = document.getElementById("menu-toggle");
        const mobileMenu = document.getElementById("mobile-menu");
        const mobileMenuPanel = document.getElementById("mobile-menu-panel");
        const mobileMenuBackdrop = document.getElementById("mobile-menu-backdrop");
        const mobileMenuClose = document.getElementById("mobile-menu-close");
        const menuIcon = document.getElementById("menu-icon");
        const closeIcon = document.getElementById("close-icon");
        const mobileNavLinks = document.querySelectorAll(".mobile-nav-link");

        function setMenuOpen(open: boolean) {
          const isOpen = open === true;
          if (mobileMenu) mobileMenu.setAttribute("data-open", isOpen ? "true" : "false");
          if (mobileMenuPanel) mobileMenuPanel.setAttribute("data-open", isOpen ? "true" : "false");
          if (menuToggle) {
            menuToggle.setAttribute("aria-expanded", isOpen ? "true" : "false");
            menuToggle.setAttribute("aria-label", isOpen ? "Close menu" : "Open menu");
          }
          if (menuIcon) menuIcon.classList.toggle("hidden", isOpen);
          if (closeIcon) closeIcon.classList.toggle("hidden", !isOpen);
          document.body.style.overflow = isOpen ? "hidden" : "";
        }

        function closeMenu() {
          setMenuOpen(false);
        }

        if (menuToggle && mobileMenu) {
          menuToggle.addEventListener("click", () => {
            const isOpen = mobileMenu.getAttribute("data-open") === "true";
            setMenuOpen(!isOpen);
          });
        }

        if (mobileMenuBackdrop) {
          mobileMenuBackdrop.addEventListener("click", closeMenu);
        }

        if (mobileMenuClose) {
          mobileMenuClose.addEventListener("click", closeMenu);
        }

        mobileNavLinks.forEach((link) => {
          link.addEventListener("click", closeMenu);
        });

        document.addEventListener("keydown", (e) => {
          if (e.key === "Escape" && mobileMenu?.getAttribute("data-open") === "true") {
            closeMenu();
          }
        });
      })();
    </script>
  </body>
</html>
