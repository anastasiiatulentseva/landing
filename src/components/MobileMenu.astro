---
interface Props {
  links: { href: string; label: string; ariaLabel?: string; external?: boolean; download?: boolean | string }[];
}
const { links } = Astro.props;
---

<!-- Rendered outside nav so position:fixed is relative to viewport (nav has backdrop-blur containing block) -->
<div
  id="mobile-menu"
  role="dialog"
  aria-modal="true"
  aria-label="Navigation menu"
  class="fixed inset-0 z-[100] md:hidden opacity-0 invisible pointer-events-none transition-all duration-300 ease-out data-[open=true]:opacity-100 data-[open=true]:visible data-[open=true]:pointer-events-auto print:hidden"
  data-open="false"
>
  <div
    id="mobile-menu-backdrop"
    class="absolute inset-0 bg-charcoal/75"
    aria-hidden="true"
  />
  <aside
    id="mobile-menu-panel"
    class="absolute top-0 right-0 bottom-0 w-full max-w-xs bg-paper shadow-2xl border-l border-gray-200 flex flex-col pt-20 px-6 translate-x-full transition-transform duration-300 ease-out data-[open=true]:translate-x-0"
    data-open="false"
  >
    <button
      type="button"
      id="mobile-menu-close"
      aria-label="Close menu"
      class="absolute top-6 right-6 p-2 text-charcoal hover:text-gold transition-colors rounded-lg hover:bg-gray-100"
    >
      <svg
        xmlns="http://www.w3.org/2000/svg"
        width="24"
        height="24"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
        aria-hidden="true"
      >
        <path d="M18 6 6 18" />
        <path d="m6 6 12 12" />
      </svg>
    </button>
    <nav class="flex flex-col gap-2 pt-8" aria-label="Mobile navigation">
      {
        links.map(({ href, label, ariaLabel, external, download }) => (
          <a
            href={href}
            class="mobile-nav-link py-4 text-lg font-medium text-charcoal hover:text-gold border-b border-gray-100 transition-colors"
            aria-label={ariaLabel ?? `Go to ${label} section`}
            target={external ? "_blank" : undefined}
            rel={external ? "noopener noreferrer" : undefined}
            download={download === true ? "" : (download || undefined)}
          >
            {label}
          </a>
        ))
      }
    </nav>
  </aside>
</div>

<style>
  /* Ensure solid background; theme token may not always apply in all browsers */
  #mobile-menu-panel {
    background-color: var(--color-paper, #faf9f6);
  }
  /* Prevent backdrop flash/overlay when menu is closed - some browsers need explicit rules */
  #mobile-menu:not([data-open="true"]) {
    visibility: hidden;
    opacity: 0;
    pointer-events: none;
  }
</style>
